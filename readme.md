# sqlshell

sqlshell is a bare-bone database management system intended for usage where efficiency is not a concern.

![sqlshell in action](snapshot.png]

### Internals

The software has, as of now, three components - lexer, parser and an execution engine. Their
functioning is as follows:

* Lexer: It takes the commands from the user via an input stream and converts it into token stream.
         The token objects so produced have an aggregate type (struct). The final output is
         a stream consisting of objects of the form <token-id, void*>. The token-id solely determines
         the type of the token and the second field - void* - can be used to pass any data to the
         parser. A multitude of token types, defined in tokentypes.h, are used by the lexer for the
         second field.
         <br> This lexer is generated automatically by the program `flex`.

* Parser: From the token stream supplied by the lexer, it generates an Abstract Syntax Tree (AST). 
          The AST is rooted at a node of type stmt_t. The types of its children are decided by the
          grammar.
          It is important to note that although the parser receives a stream of untyped objects
          from the lexer, the token-id field is used to determine the type of the object. In this 
          way, the parser implicitly assumes that the output of the lexer is consistent - if the 
          token-id is x, then the second field must have a type assigned to the token of type x.
          These tokenid - tokentypes mapping have to be concurred in advance by both the lexer 
          and parser.
          <br> This parser is generated by bison.

* Execution Engine: The execution engine traverses the AST produced by the parser and executes them
                    appropriately. It maintains, for each type of node, an exec function which is
                    to be invoked when that type of node is encountered. This component handles 
                    all the nitty-gritty details of storage, retrieval, searching etc. of the 
                    databases encapsulated in the exec functions. It is expected that this component
                    would be further split in future.
                    <br> The execution engine is intentionally separated from the parser to make
                    the parser storage independent. With this architecture, the representation of
                    databases can be changed by this only this component.
